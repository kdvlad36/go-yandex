# Шаблоны для деплоя функции excel-report

В этой директории содержатся шаблоны для деплоя функции excel-report с различными конфигурациями.

## Доступные шаблоны

1. **deploy-with-cron.sh** - деплой функции с крон-триггером
   - Запускает функцию по расписанию (по умолчанию в 9:00 по будням)
   - Для изменения расписания отредактируйте переменную `CRON_EXPRESSION`

2. **deploy-with-ymq.sh** - деплой функции с триггером из очереди YMQ
   - Создает очередь YMQ для отправки сообщений
   - Создает триггер для вызова функции при появлении сообщений в очереди
   - Для тестирования используйте команду:
     ```
     yc message-queue message send --queue-name=excel-report-queue --data='{"projectName":"Тестовый проект"}'
     ```

3. **deploy-with-secrets.sh** - деплой функции с использованием секретов
   - Создает секрет с тестовыми данными (в реальном проекте замените на свои)
   - Привязывает секрет к функции
   - Секреты будут доступны в функции через переменные окружения с префиксом `SECRET_`

4. **deploy-full.sh** - полный деплой функции с крон, YMQ и секретами
   - Объединяет все вышеперечисленные шаблоны в один
   - Рекомендуется для полной настройки функции

## Как использовать

1. Сделайте скрипты исполняемыми:
   ```
   chmod +x *.sh
   ```

2. Запустите нужный скрипт:
   ```
   ./deploy-with-cron.sh
   ```
   или
   ```
   ./deploy-with-ymq.sh
   ```
   или
   ```
   ./deploy-with-secrets.sh
   ```
   или для полного деплоя:
   ```
   ./deploy-full.sh
   ```

## Настройка параметров

Перед запуском вы можете отредактировать скрипты и настроить параметры:

- `FUNCTION_NAME` - имя функции
- `CRON_EXPRESSION` - крон-выражение для расписания
- `YMQ_QUEUE_NAME` - имя очереди YMQ
- `SECRET_NAME` - имя секрета

## Требования

- Установленный и настроенный Yandex Cloud CLI (`yc`)
- Настроенный профиль с доступом к Yandex Cloud Functions, Message Queue и Lockbox 