# Генератор Excel-отчетов

Это серверлесс-функция на языке Go для платформы Yandex Cloud, которая генерирует Excel-отчеты по проекту.

## Функциональность

Функция принимает название проекта и генерирует простой Excel-отчет, содержащий следующие колонки:
- № (порядковый номер)
- Показатель (название показателя)
- Значение (числовое значение)
- Дата (дата показателя)

## Использование

Для вызова функции отправьте POST-запрос на эндпоинт `/excel-report` со следующим телом запроса:

```json
{
    "projectName": "Название проекта"
}
```

Функция вернет Excel-файл (.xlsx) с отчетом.

## Параметры конфигурации

В этой директории находится отдельный `serverless.yml` для функций на Go, что позволяет разделить их от функций Node.js. Функция настроена следующим образом:
- Service: golang-functions
- Runtime: golang121
- Память: 256 МБ
- Таймаут: 30 секунд
- Метод запроса: POST
- Путь: /excel-report

## Доработка

В текущей реализации функция генерирует демонстрационные данные. 
Для интеграции с реальными данными необходимо реализовать:

1. Подключение к базе данных (например, ClickHouse или Firestore)
2. Получение реальных данных по указанному проекту
3. Формирование отчета на основе полученных данных

## Компиляция и деплой

Для деплоя функции выполните следующую команду из директории go/excel-report:

```bash
# Деплой функции
./deploy.sh
```

Скрипт deploy.sh выполнит следующие действия:
1. Обновит зависимости Go с помощью `go mod tidy`
2. Проверит ошибки компиляции
3. Выполнит деплой через Serverless Framework: `npx serverless deploy --config serverless.yml` 